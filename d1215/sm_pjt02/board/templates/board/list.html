<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>VLAST Shop - 게시판</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.0/css/all.min.css" integrity="sha512-10/jx2EXwxxWqCLX/hHth/vu2KY3jCF70dCQB8TSgNjbCVAC/8vai53GfMDrO2Emgwccf2pJqxct9ehpzG+MTw==" crossorigin="anonymous" referrerpolicy="no-referrer" />
  <link href="css/style.css" rel="stylesheet" type="text/css" >
  <link href="/static/css/board_write.css" rel="stylesheet" type="text/css" >
  <link href="/static/css/board_list.css" rel="stylesheet" type="text/css" >
  <script src="https://kit.fontawesome.com/yourcode.js" crossorigin="anonymous"></script>
  <script src="/static/js/jquery-3.6.0.min.js"></script>
  <script>
    if('{{flag}}'=='2'){
      alert("답변달기가 등록되었습니다.");
      location.href='/board/list/';
    }
    $(function() {
      $("#save").click(function(){
        var url = "{% url 'board:write' %}"
        $.ajax({
            type:'POST',
            url:url,
            data:$("#writeForm").serialize(),
            success:function(data){
                console.log("success",data);
                if(data.flag=="1"){
                  alert("저장완료되었습니다.");
                  location.href = "/board/list/"
                }else{
                  alert("저장실패");
                }
            },
            error : function(xhr,errmsg,err) {
                console.log(errmsg);
                alert("서버에러: ",errmsg)
            }
        });
      });
    });
  </script>
</head>
<body>
  <!-- Header -->
  <div class="header">
    <div class="top-menu">
      <a href="#"><i class="fa-regular fa-chess-queen"></i> 회원가입</a> |
      <a href="#">로그인</a> |
      <a href="#">주문조회</a> |
      <a href="#">최근본상품</a>
    </div>
    <div class="icons">
      <i class="fas fa-search"></i>
      <i class="fas fa-user"></i>
      <i class="fas fa-shopping-bag"></i>
    </div>
  </div>
  <!-- nav -->
  <nav>
    <ul>
      <li><a href="#">포레스트</a></li>
      <li><a href="#">스파</a></li>
      <li><a href="#">객실</a></li>
      <li><a href="#">특별한 경험</a></li>
      <li><a href="#">부대시설</a></li>
      <li><a href="#">브랜드소개</a></li>
    </ul>
  </nav>
  <!-- banner -->
  <div class="banner"></div>
  <!-- 글쓰기 폼 -->
  <div class="write-container">
    <div class="write-title">게시글 작성</div>
    <form class="write-form" id="writeForm" action="{% url 'board:write' %}" method="post">
      {% csrf_token %}
      <input type="text" id="writer" name="id" placeholder="작성자" maxlength="20" required value="{{request.session.session_id}}" readonly />
      <input type="text" id="title" name="btitle" placeholder="제목" maxlength="100" required />
      <textarea id="content" name="bcontent" placeholder="내용을 입력하세요." maxlength="2000" required></textarea>

      <div class="write-buttons">
        <button type="button" id="save">등록</button>
        <button type="button" class="cancel" onclick="history.back()">취소</button>
      </div>
    </form>
  </div>
  <!-- Board List -->
  <div class="board-container">
    <div class="board-title">공지사항</div>
    <table class="board-table">
      <colgroup>
        <col width='10%'>
        <col width='*'>
        <col width='15%'>
        <col width='20%'>
        <col width='15%'>
      </colgroup>
      <thead>
        <tr>
          <th>번호</th>
          <th>제목</th>
          <th>작성자</th>
          <th>작성일</th>
          <th>조회수</th>
        </tr>
      </thead>
      <tbody>
        {% if list %}
          {% for b in list %}
            <tr>
              <td>{{b.bno}}</td>
              <td class="title">
                <a href="/board/view/{{b.bno}}">{% for i in ''|rjust:b.bindent %}▶{% endfor %}{{b.btitle}}</a>
              </td>
              <td>{{b.member.name}}</td>
              <td class="date">{{b.bdate|date:'Y-m-d H:i:s'}}</td>
              <td class="views">{{b.bhit}}</td>
            </tr>
          {% endfor %}
        {% else %}
          <tr>
            <td colspan='5'>데이터가 존재하지 않습니다.</td>
          </tr>
        {% endif %}
      </tbody>
    </table>
    <!-- Write Button -->
    <div class="write-box">
      <a href="/board/write" class="write-btn">글쓰기</a>
    </div>
    <!-- Pagination & Search -->
    <div class="board-footer" >
        <div class="pagination">
            <!-- 이전 페이지 링크 -->
            {% if list.has_previous %}
                <a href="{% url 'board:list' %}?page={{ list.previous_page_number }}">&laquo;</a>
            {% else %}
                <a href="#" class="disabled">&laquo;</a>
            {% endif %}
    
            <!-- 페이지 번호 루프 -->
            {% for i in list.paginator.page_range %}
                {% if list.number == i %}
                    <a href="#" class="active">{{ i }}</a>
                {% else %}
                    <a href="{% url 'board:list' %}?page={{ i }}">{{ i }}</a>
                {% endif %}
            {% endfor %}
    
            <!-- 다음 페이지 링크 -->
            {% if list.has_next %}
                <a href="{% url 'board:list' %}?page={{ list.next_page_number }}">&raquo;</a>
            {% else %}
                <a href="#" class="disabled">&raquo;</a>
            {% endif %}
        </div>
        <div class="search-box">
            <input type="text" placeholder="검색어 입력">
            <button>검색</button>
        </div>
    </div>
  </div>
  <!-- Footer -->
  <footer>
    Copyright © VLAST Shop. All rights reserved.
  </footer>
</body>
</html>